# ログイン画面 - 作業手順

## 目的
- 社内ナレッジ共有サイトのフロントエンドにおけるログイン画面を実装し、要件定義・基本設計に従って安全で使いやすい認証フローを提供する。

## 前提条件
- 開発ブランチ：`feature/*`（作業用ブランチを作成してください）
- Node.js / npm がインストールされていること
- 開発サーバー起動コマンド：

```bash
cd NaviAI-Front
npm install
npm run dev
```

- 使用するAPIエンドポイント情報はバックエンド設計に従う（クライアントにはCORSやベースURL設定が必要）。

## 参照資料
- 要件定義・基本設計（関連ファイル）:
  - [proj-1sys-ax-2025/docs/00_personal/nishizawa/統合要件定義書.md](proj-1sys-ax-2025/docs/00_personal/nishizawa/統合要件定義書.md)
  - [proj-1sys-ax-2025/docs/00_personal/nishizawa/基本設計_API.md](proj-1sys-ax-2025/docs/00_personal/nishizawa/基本設計_API.md)
  - [proj-1sys-ax-2025/docs/00_personal/nishizawa/基本設計_DB.md](proj-1sys-ax-2025/docs/00_personal/nishizawa/基本設計_DB.md)

## 成果物（想定ファイル）
- `NaviAI-Front/app/pages/login/index.tsx` - 画面エントリ
- `NaviAI-Front/app/pages/login/login.module.css` - スタイル
- `NaviAI-Front/app/components/LoginForm.tsx` - 再利用可能なフォームコンポーネント
- `NaviAI-Front/app/lib/auth.ts` - 認証ユーティリティ（API呼び出し、トークン管理）
- `NaviAI-Front/__tests__/LoginForm.test.tsx` - ユニットテスト

## 作業手順（詳細）

1. 要件・設計確認（1日）
   - 参照資料を読み、認証フロー（ログイン成功時・失敗時・トークン保存・リダイレクト要件）を洗い出す。
   - アクセシビリティ要件（キーボード操作、ラベル、ARIA）を確定する。

2. 画面モック作成（0.5日）
   - 既存共通ヘッダーを確認し、ログイン画面のモックをSketch/Figmaまたは簡易HTMLで作成する。
   - 参考ファイル: `NaviAI-Front/app/pages/dashboard/common_header.html` とスタイル参照。

3. コンポーネント実装（1〜2日）
   - `LoginForm` コンポーネントを実装。
     - フィールド: `email` or `username`, `password`。
     - UI要素: ラベル、入力欄、パスワード表示切替（任意）、ログインボタン、パスワード忘れリンク。
   - 入力は制御コンポーネントとして実装し、`onSubmit`で親へイベントを渡す設計にする。

4. スタイル適用（0.5日）
   - CSS モジュールまたはプロジェクト既存スタイルに沿って `login.module.css` を作成。
   - モバイル／レスポンシブ対応を確認する。

5. 入力バリデーション・アクセシビリティ（0.5日）
   - クライアント側バリデーション: 必須チェック、メール形式チェック（必要なら）。
   - フォームエラーの表示方法を決定し、スクリーンリーダーで読めるようにする（`aria-live`等）。

6. API連携・認証処理（1日）
   - `auth.ts` にログインAPI呼び出しを実装（`fetch`/`axios`）。
   - 成功時はトークンを `localStorage` または `httpOnly cookie` に保存（セキュリティ要件に従う）。
   - ログイン成功後はダッシュボードへリダイレクト。
   - 失敗時はユーザーへ適切なエラーメッセージを表示。

7. テスト実装（1日）
   - ユニットテスト: フォームの入力、バリデーション、送信ハンドリングをカバーする。
   - E2E (任意): ログイン成功/失敗シナリオをCypress等で確認する。

8. セキュリティレビュー・アクセシビリティチェック（0.5日）
   - トークン管理方法の確認（XSS/CSRF対策）。
   - パスワード入力の自動補完設定、強度要件の検討。

9. コードレビュー・PR作成（0.5日）
   - PRテンプレートにチェックリストを入れ、レビュワーを指定する。

10. ステージングデプロイと最終確認（0.5日）
   - ステージングで動作確認。ログイン→ダッシュボード遷移、セッション保持を確認する。

## 受入基準（Acceptance Criteria）
- 正しい資格情報でログインするとダッシュボードへ遷移する。
- 誤った認証情報では適切なエラーメッセージが表示される。
- 入力エラーがある場合、画面上にフィードバックが出る。
- キーボード操作でフォームを使える（フォーカス順、Enterで送信）。
- スマホ・デスクトップでレイアウトが崩れない。

## QAチェックリスト
- レスポンシブ表示確認（各ブレークポイント）
- ARIA属性・ラベル確認
- エラーメッセージの日本語表記確認（整合性）
- ブラウザの戻る/リロード時の挙動確認
- トークンの保存場所・有効期限の確認

## 備考・運用メモ
- 多言語対応が必要な場合はメッセージを `i18n` 化すること（日本語がデフォルト）。
- 本手順は最小実装を想定。追加要件（SSO、2FA等）は別タスクで実施。

---
作成日時: 2026-01-20
作成者: 開発チーム
